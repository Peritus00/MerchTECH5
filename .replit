# The entrypoint is the file that is shown when the Repl is opened.
entrypoint = "README.md"

# Specifies the environment modules to use.
modules = ["nodejs-20", "postgresql-16"]

[nix]
# The Nix channel to use for package management.
channel = "stable-24_05"

# --- PORT CONFIGURATION ---
[[ports]]
localPort = 5001
[[ports]]
localPort = 8081
externalPort = 80

# --- WORKFLOWS ---
[workflows]
runButton = "Run App"

[[workflows.workflow]]
name = "Run App"
mode = "parallel"

[[workflows.workflow.tasks]]
# Task 1: Start the stable backend server.
# FIX: Using nodemon for a more stable development server process.
# It will automatically install and run nodemon.
task = "shell.exec"
args = "npx nodemon server/working-server.js"

[[workflows.workflow.tasks]]
# Task 2: Start the Expo frontend development server.
task = "shell.exec"
args = "npx expo start --web --clear"

# --- DEPLOYMENT CONFIGURATION ---
[deployment]
# For deployment, we still use the standard node command.
run = ["sh", "-c", "node server/working-server.js"]

