# The entrypoint is the file that is shown when the Repl is opened.
entrypoint = "README.md"

# Specifies the environment modules to use.
modules = ["nodejs-20", "postgresql-16"]

[nix]
# The Nix channel to use for package management.
channel = "stable-24_05"

[[ports]]
localPort = 5001

[[ports]]
localPort = 8081
externalPort = 80

# --- WORKFLOWS ---
[workflows]
# The "Run" button will execute the "Run App" workflow below.
runButton = "Run App"

[[workflows.workflow]]
# This is the final workflow to run your full application for development.
name = "Run App"
mode = "parallel" # Runs both tasks at the same time.

[[workflows.workflow.tasks]]
# Task 1: Start the backend server.
# FIX: Pointing to the correct path for the main server file.
task = "shell.exec"
args = "node services/Server/main.js"

[[workflows.workflow.tasks]]
# Task 2: Start the frontend Expo server.
task = "shell.exec"
args = "npx expo start --web --clear"

# --- DEPLOYMENT CONFIGURATION ---
[deployment]
# The deployment command is also updated to the correct path.
run = ["sh", "-c", "node services/Server/main.js"]
